function attemptSignin(e,t,r,i,a){$.ajax({method:"POST",url:"index",data:{email:e,password:t,totp:r,url:i,token:a,action:"sign_in_to_dms"},timeout:14e3,beforeSend:function(){$("#signin").attr("disabled",!0),$("#signin").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Signing in...')}}).done((function(e,t,r){let i=JSON.parse(e);if(0===i.res)return $("#msg0").html(i.msg),void showAlertDanger();1===i.res&&($("#form-signin").trigger("reset"),location.href=i.msg)})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$("#signin").html("Sign in"),$("#signin").attr("disabled",!1)}))}function attemptRecovercredentials(e,t,r){$.ajax({method:"POST",url:"index",data:{"email-recovercredentials":e,key:t,token:r,action:"recover_credentials"},timeout:14e3,beforeSend:function(){$("#submit").attr("disabled",!0),$("#submit").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Submitting...')}}).done((function(e,t,r){let i=JSON.parse(e);if(0===i.res)return $("#msg0").html(i.msg),void showAlertDanger();1===i.res&&($("#form-recovercredentials").trigger("reset"),$("#msg1").html(i.msg),showAlertSuccess())})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$("#submit").html("Submit"),$("#submit").attr("disabled",!1)}))}function attemptResetpassword(e,t,r,i,a){$.ajax({method:"POST",url:"index",data:{newPass:e,cnfPass:t,t:r,e:i,token:a,action:"reset_password"},timeout:14e3,beforeSend:function(){$("#submit").attr("disabled",!0),$("#submit").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Submitting...')}}).done((function(e,t,r){let i=JSON.parse(e);if(0===i.res)return $("#msg0").html(i.msg),void showAlertDanger();1===i.res&&($("#form-resetpass").trigger("reset"),location.href=i.msg)})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$("#submit").html("Submit"),$("#submit").attr("disabled",!1)}))}function setTimer(){$.ajax({method:"POST",url:"",data:{timer:1},timeout:14e3}).done((function(e,t,r){if(r.getResponseHeader("content-security-policy"))return void redirect();1===JSON.parse(e).res&&setTimerVal()})).fail((function(e,t,r){$("#msg0").html("Error in processing RESET TIMER request: "+r+"."),showAlertDanger()}))}function setTimerVal(){localStorage.timer=+new Date+parseInt(84e4);let e=setInterval((function(){let t=localStorage.timer-new Date;if(t>=0){let e,r,i;e=Math.floor(t/1e3),r=parseInt(e/60,10),i=parseInt(e%60,10),r=r<10?"0"+r:r,i=i<10?"0"+i:i,$("#timer").text(r+":"+i)}else clearInterval(e),location.href="/logout?url="+location.pathname+"&sess=0"}),100)}function validateFileType(e,t){if("common"===t)var r=["pdf","doc","docx","xls","xlsx","ppt","pptx","eml","msg","rar"],i="PDF, Word, Excel, PowerPoint, WebMail, OutlookMail or RAR";if("pdf"===t)r=["pdf"],i="PDF only";return r.includes(e)?($("#fileErr").html(""),!0):($("#file").val(""),$("#fileErr").html("File Error: Please choose a valid file. ("+i+")"),!1)}function validateFileSize(e,t){if(e>1048576*t)return $("#file").val(""),void $("#fileErr").html("File Error: File size shouldn't exceed "+t+" MB.");$("#fileErr").html("")}function showAlertDanger(){$("#res0").fadeIn("slow"),$("#res0")[0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}function showAlertSuccess(){$("#res1").fadeIn("slow"),$("#res1")[0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}function redirect(){location.href="/?url="+location.pathname+"&sess=0"}function validateInteger(e,t){return new RegExp("^[0-9]{"+t+"}$").test(e)}function dmsminjs(){}$((function(){"use strict";const e=new Date,t=e.getFullYear();parseInt(e.getMonth()+1),e.getDate();$("#form-signin").on("submit",(function(e){return e.preventDefault(),$.trim($("#email").val())&&$.trim($("#password").val())&&$.trim($("#totp").val())?validateInteger($("#totp").val(),"6")?void grecaptcha.ready((function(){grecaptcha.execute("6LcmZj4hAAAAAD_nfd1G2ElMlb7kTn6m-Zp1yS6N",{action:"sign_in_to_dms"}).then((function(e){let t,r,i,a;t=$("#email").val(),r=$("#password").val(),i=$("#totp").val(),a=$("#url").val(),attemptSignin(t,r,i,a,e)}))})):($("#msg0").html("<b>Error:</b> TOTP must contain 6 digits."),void showAlertDanger()):($("#msg0").html("<b>Error:</b> Invalid data was submitted in field(s)."),void showAlertDanger())})),$("#form-recovercredentials").on("submit",(function(e){return e.preventDefault(),$.trim($("#email-recovercredentials").val())&&$.trim($("#key").val())?validateInteger($("#key").val(),"5,10")?void grecaptcha.ready((function(){grecaptcha.execute("6LcmZj4hAAAAAD_nfd1G2ElMlb7kTn6m-Zp1yS6N",{action:"recover_credentials"}).then((function(e){let t,r;t=$("#email-recovercredentials").val(),r=$("#key").val(),attemptRecovercredentials(t,r,e)}))})):($("#msg0").html("<b>Error:</b> Key must contain minimum 5 and maximum 10 digits."),void showAlertDanger()):($("#msg0").html("<b>Error:</b> Invalid data was submitted in field(s)."),void showAlertDanger())})),$("#form-resetpass").on("submit",(function(e){return e.preventDefault(),$.trim($("#newPass").val())&&$.trim($("#cnfPass").val())?$("#newPass").val()!==$("#cnfPass").val()?($("#msg0").html("<b>Error:</b> New password & confirm new password do not match. Try again!"),void showAlertDanger()):void grecaptcha.ready((function(){grecaptcha.execute("6LcmZj4hAAAAAD_nfd1G2ElMlb7kTn6m-Zp1yS6N",{action:"reset_password"}).then((function(e){let t,r,i,a;t=$("#newPass").val(),r=$("#cnfPass").val(),i=$("#t").val(),a=$("#e").val(),attemptResetpassword(t,r,i,a,e)}))})):($("#msg0").html("<b>Error:</b> Invalid data was submitted in field(s)."),void showAlertDanger())})),$("#form-radio-mobile").on("submit",(function(e){return e.preventDefault(),$.trim($("#countryCode").val())&&$.trim($("#mobile").val())&&$.trim($("#curPassM").val())&&$.trim($("#totpM").val())?validateInteger($("#mobile").val(),"10")?validateInteger($("#totpM").val(),"6")?void $.ajax({method:"POST",url:"index",data:$(this).serialize(),timeout:14e3,beforeSend:function(){$("#submitM").attr("disabled",!0),$("#submitM").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Submitting...')}}).done((function(e,t,r){if(r.getResponseHeader("content-security-policy"))return void redirect();setTimerVal();let i=JSON.parse(e);return 1===i.res?($("#form-radio-mobile").trigger("reset"),$("select").length&&$("#form-radio-mobile").find(".selectized").each((function(e,t){t.selectize&&t.selectize.clear()})),document.body.scrollTop=document.documentElement.scrollTop=0,void(location.href=i.msg)):0===i.res?($("#msg0").html(i.msg),void showAlertDanger()):void(2===i.res&&(localStorage.setItem("logout-event","logout"+Math.random()),location.href=i.msg))})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$("#submitM").html("Submit"),$("#submitM").attr("disabled",!1)})):($("#msg0").html("<b>Error:</b> TOTP must contain 6 digits."),void showAlertDanger()):($("#msg0").html("<b>Error:</b> Mobile number must contain 10 digits."),void showAlertDanger()):($("#msg0").html("Ahem! Required fields can't be left empty."),void showAlertDanger())})),$("#form-radio-key").on("submit",(function(e){return e.preventDefault(),$.trim($("#key").val())&&$.trim($("#curPassK").val())&&$.trim($("#totpK").val())?validateInteger($("#key").val(),"5,10")?validateInteger($("#totpK").val(),"6")?void $.ajax({method:"POST",url:"index",data:$(this).serialize(),timeout:14e3,beforeSend:function(){$("#submitK").attr("disabled",!0),$("#submitK").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Submitting...')}}).done((function(e,t,r){if(r.getResponseHeader("content-security-policy"))return void redirect();setTimerVal();let i=JSON.parse(e);return 1===i.res?($("#form-radio-key").trigger("reset"),document.body.scrollTop=document.documentElement.scrollTop=0,void(location.href=i.msg)):0===i.res?($("#msg0").html(i.msg),void showAlertDanger()):void(2===i.res&&(localStorage.setItem("logout-event","logout"+Math.random()),location.href=i.msg))})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$("#submitK").html("Submit"),$("#submitK").attr("disabled",!1)})):($("#msg0").html("<b>Error:</b> TOTP must contain 6 digits."),void showAlertDanger()):($("#msg0").html("<b>Error:</b> Key must contain minimum 5 and maximum 10 digits."),void showAlertDanger()):($("#msg0").html("Ahem! Required fields can't be left empty."),void showAlertDanger())})),$("#form-radio-password").on("submit",(function(e){return e.preventDefault(),$.trim($("#newPass").val())&&$.trim($("#cnfPass").val())&&$.trim($("#curPassP").val())&&$.trim($("#totpP").val())?$("#newPass").val()!==$("#cnfPass").val()?($("#msg0").html("<b>Error:</b> New password & confirm new password do not match. Try again!"),void showAlertDanger()):$("#newPass").val()===$("#curPassP").val()?($("#msg0").html("<b>Error:</b> Current password and new password must not be same."),void showAlertDanger()):validateInteger($("#totpP").val(),"6")?void $.ajax({method:"POST",url:"index",data:$(this).serialize(),timeout:14e3,beforeSend:function(){$("#submitP").attr("disabled",!0),$("#submitP").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Submitting...')}}).done((function(e,t,r){if(r.getResponseHeader("content-security-policy"))return void redirect();setTimerVal();let i=JSON.parse(e);return 1===i.res?($("#form-radio-password").trigger("reset"),localStorage.setItem("logout-event","logout"+Math.random()),void(location.href=i.msg)):0===i.res?($("#msg0").html(i.msg),void showAlertDanger()):void(2===i.res&&(localStorage.setItem("logout-event","logout"+Math.random()),location.href=i.msg))})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$("#submitP").html("Submit"),$("#submitP").attr("disabled",!1)})):($("#msg0").html("<b>Error:</b> TOTP must contain 6 digits."),void showAlertDanger()):($("#msg0").html("Ahem! Required fields can't be left empty."),void showAlertDanger())})),$("#form-email").on("submit",(function(e){if(e.preventDefault(),!$.trim($("#subject").val())||!$.trim($("#message").val()))return $("#msg0").html("<b>Error:</b> Invalid data was submitted in field(s)."),void showAlertDanger();$.ajax({method:"POST",url:"index",data:$(this).serialize(),timeout:14e3,beforeSend:function(){$("#submit").attr("disabled",!0),$("#submit").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Submitting...')}}).done((function(e,t,r){if(r.getResponseHeader("content-security-policy"))return void redirect();setTimerVal();let i=JSON.parse(e);if(1===i.res)return $("#msg1").html(i.msg),$("#form-email").trigger("reset"),$("#form-email").find("*").filter(":input:visible:first").focus(),void showAlertSuccess();0===i.res&&($("#msg0").html(i.msg),showAlertDanger())})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$("#submit").html("Submit"),$("#submit").attr("disabled",!1)}))})),$("#form-upload").on("submit",(function(e){e.preventDefault(),$.ajax({method:"POST",url:"write",data:new FormData(this),timeout:84e4,contentType:!1,processData:!1,beforeSend:function(){$("#upload").attr("disabled",!0),$("#upload").html('<i class="fa-solid fa-spinner fa-spin-pulse fa-xl fa-fw"></i>Uploading...'),$("#file-progress-bar").width("0%"),$(".progress").fadeIn("slow")},xhr:function(){let e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){let t=Math.ceil(e.loaded/e.total*100);$("#file-progress-bar").width(t+"%"),$("#file-progress-bar").html(t+"%")}}),!1),e}}).done((function(e,t,r){if(r.getResponseHeader("content-security-policy"))return void redirect();setTimerVal();let i=JSON.parse(e);if(1===i.res)return $("#msg1").html(i.msg),$("#form-upload").trigger("reset"),$("select").length&&$("#form-upload").find(".selectized").each((function(e,t){t.selectize&&t.selectize.clear()})),showAlertSuccess(),void setTimeout((function(){$("#form-upload").find("*").filter(":input:visible:first").focus()}),1500);0===i.res&&($("#msg0").html(i.msg),showAlertDanger())})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()})).always((function(){$(".progress").fadeOut("slow"),$("#upload").html("Upload"),$("#upload").attr("disabled",!1)}))})),$(".radio-departments").on("click",(function(){let e=$(this).val();$.ajax({method:"POST",url:"index",data:{department:e},timeout:14e3,beforeSend:function(){$(".alert, #tabledi-container").hide()}}).done((function(e,t,r){if(r.getResponseHeader("content-security-policy"))return void redirect();setTimerVal();let i=JSON.parse(e);if(1===i.res){$.fn.DataTable.isDataTable("#tabledi")&&$("#tabledi").DataTable().clear().destroy(),$("#tbody").find("tr").remove();for(let e in i.msg){let t=`<tr><td>${i.msg[e]}</td><td class="fitContent"><a href="${i.dep+"/"+e.concat("/read")}"><button type="button" class="btn btn-primary btn-sm">Read</button></a>&nbsp;/&nbsp;<a href="${i.dep+"/"+e.concat("/write")}"><button type="button" class="btn btn-primary btn-sm">Write</button></a></td></tr>`;$("#tbody").append(t)}return $("#tabledi-container").fadeIn("slow"),$("#tabledi").DataTable({ordering:!1}),$(".dataTables_length select").addClass("form-select form-select-sm dark"),$(".dataTables_filter input").addClass("form-control form-control-sm dark").focus(),void $(".dataTables_filter input")[0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}0===i.res&&($("#msg0").html(i.msg),showAlertDanger())})).fail((function(e,t,r){$("#msg0").html("Error in processing request: "+r+"."),showAlertDanger()}))})),$('[data-selection-selectize="selectize"]').selectize({sortField:{field:"text"}}),$('[data-selection-selectize="selectizeC"]').selectize({sortField:{field:"text"},create:!0}),$('[data-selection-selectize="selectizem"]').selectize({sortField:{field:"text"},plugins:["remove_button"]}),$('[data-selection-selectize="selectizemC"]').selectize({sortField:{field:"text"},create:!0,plugins:["remove_button"]}),$('[data-selection-datepicker="date"]').datepicker({startView:2,format:"yyyy-mm-dd",startDate:t-12+"-01-01",endDate:Date.now(),autoHide:!0}),$('[data-selection-datepicker="dateYM"]').datepicker({startView:2,format:"yyyy-mm",startDate:t-12+"-01-01",endDate:Date.now(),autoHide:!0}),$('[data-selection-datepicker="dateY"]').datepicker({startView:2,format:"yyyy",startDate:t-12+"-01-01",endDate:Date.now(),autoHide:!0}),$('[data-selection-datepicker="dateFY"]').datepicker({startView:2,startDate:t-12+"-01-01",endDate:Date.now(),format:"yyyy",autoHide:!0,pick:function(e){e.preventDefault();let t=e.date.getFullYear(),r=t+"-"+(t+1);$(this).val(r)}}),$('[data-selection-datepicker="dateAY"]').datepicker({startView:2,startDate:t-12+"-01-01",endDate:Date.now()+31536e6,format:"yyyy",autoHide:!0,pick:function(e){e.preventDefault();let t=e.date.getFullYear(),r=t+"-"+(t+1);$(this).val(r)}}),$('[data-selection-datepicker="dateAYD"]').datepicker({startView:2,format:"yyyy-mm-dd",startDate:t-12+"-01-01",endDate:Date.now()+31536e6,autoHide:!0}),$('[data-selection-datepicker="dateF"]').datepicker({startView:2,format:"yyyy-mm-dd",startDate:Date.now()+864e5,endDate:t+12+"-01-01",autoHide:!0}),$('[data-dd="retType"]').on("change",(function(){$(".hidden").hide(),"Monthly"===$(this).val()?$("#yearMonthBlock").fadeIn("slow"):"Quarterly"===$(this).val()&&$("#quarterBlock").fadeIn("slow")})),$('[data-dd="spark_reports"]').on("change",(function(){$(".hidden").hide(),"Daily"===$(this).val()?$("#dateBlock").fadeIn("slow"):$("#yearMonthBlock").fadeIn("slow")})),$('[data-dd="cashflows"]').on("change",(function(){$(".hidden").hide(),"Daily Cash Flow"===$(this).val()?$("#dateBlock").fadeIn("slow"):$("#yearMonthBlock").fadeIn("slow")})),$('[data-dd="pr"]').on("change",(function(){$(".hidden").hide(),"Daily Progress Report"===$(this).val()?$("#dateBlock").fadeIn("slow"):$("#yearMonthBlock").fadeIn("slow")})),$("#tablei thead tr:eq(1) th").each((function(){let e=$(this).text();$(this).html('<input type="search" class="column_search form-control form-control-sm dark" placeholder="Search '+e+'" />')}));let r=$("#tablei").on("xhr.dt",(function(e,t,r,i){i.getResponseHeader("content-security-policy")?redirect():"timeout"===i.statusText&&($("#msg0").html("Error in processing request: "+i.statusText+"."),showAlertDanger())})).DataTable({orderCellsTop:!0,processing:!0,serverSide:!0,ajax:{method:"POST",url:"read",data:function(e){e.csrfToken=$("#csrfToken").val()},timeout:14e3,beforeSend:function(){setTimeout((function(){$(".alert").hide()}),7e3)},dataSrc:function(e){return setTimerVal(),0===e.res?($("#msg0").html(e.msg),void showAlertDanger()):e.data}},deferRender:!0,order:[[0,"desc"]],search:{return:!0}});$("#tablei thead").on("keyup change clear",".column_search",(function(e){13===e.keyCode&&r.column($(this).parent().index()).search(this.value).draw()})),$("#tablec").on("click","button",(function(){$(this).blur(),$(".alert").hide(),$(this).hasClass("show-alert")&&($("#msg0").html("Company / project not yet on DMS. We are working! Please check back in some days!"),showAlertDanger())})),$("#tablec").DataTable({ordering:!1}),$(".dataTables_length select").addClass("form-select form-select-sm dark"),$(".dataTables_filter input").addClass("form-control form-control-sm dark").focus(),$.fn.dataTable.ext.errMode="none",$.fn.dataTable.ext.errMode=()=>{$("#msg0").html("Error in processing request: Table error."),showAlertDanger()},$("#toggle-form-containers").on("click",(function(e){e.preventDefault(),'<i class="fa-solid fa-unlock fa-fw"></i>Recover credentials?'===$(this).html()?$(this).html('<i class="fa-solid fa-right-to-bracket fa-fw"></i>Sign in to DMS?'):$(this).html('<i class="fa-solid fa-unlock fa-fw"></i>Recover credentials?'),$("#form-signin-container, #form-recovercredentials-container").toggle("slow")})),$(".btn-close").on("click",(function(){$(this).closest(".alert").fadeOut("slow")})),$(".hide-alert").on("click",(function(){$(".alert").hide()})),$(".blur").on("click",(function(){$(this).blur()})),$("#newPass, #cnfPass").on("paste",(function(e){e.preventDefault()})),$('[type="radio"]').prop("checked",!1),$(".radio-teamprogress").on("click",(function(){$(".hidden").hide();let e=$(this).val();$("#show"+e).fadeIn("slow")})),$(".radio-userprofile").on("click",(function(){$(".alert").hide(),$(".hidden").hide();let e=$(this).val();$("#show-"+e).fadeIn("slow"),$("#form-"+e).find("*").filter(":input:visible:first")[0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),setTimeout((function(){$("#form-"+e).find("*").filter(":input:visible:first").focus()}),500)})),$("#logout").on("click",(function(){localStorage.setItem("logout-event","logout"+Math.random())})),$("#timer-reset").on("click",(function(e){e.preventDefault(),setTimer(),$("#timer-reset").css("pointer-events","none"),setTimeout((function(){$("#timer-reset").css("pointer-events","auto")}),6e4)})),$("#timer-reset").length&&setTimerVal(),$("#tablei tbody").on("click","a",(function(){setTimerVal()})),$("#form-email, #form-upload").find("*").filter(":input:visible:first").focus(),$("#file").on("change",(function(){if(!$("#file")[0].files.length)return;let e=this.files[0],t=e.name.split(".").pop().toLowerCase(),r=e.size,i=this.getAttribute("data-valid-file-type"),a=parseInt(this.getAttribute("data-valid-file-size"));validateFileType(t,i)&&validateFileSize(r,a)}))})),window.addEventListener("storage",(function(e){"logout-event"===e.key&&(location.href="/logout")}));let tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map((function(e){return new bootstrap.Tooltip(e)}));